jQuery(function(i){"use strict";function e(i){i&&i.preventDefault(),a.removeClass("ignition-wc-search-form-expanded"),s.focus()}function n(i){i&&i.preventDefault(),a.addClass("ignition-wc-search-form-expanded").find("input").focus()}function t(){return a.hasClass("ignition-wc-search-form-expanded")}function r(){g.hide()}function o(e,n){return i.ajax({url:ignition_wc_search.ajax_url,method:"post",data:{action:"ignition_wc_search_products",product_cat:e,s:n}})}function c(i,e){return e.trim().length<3?void r():(a.addClass("is-loading"),o(i,e).done(function(i){if(a.removeClass("is-loading"),i.error){var e=m.clone(),n=i.errors.join(", ");return e.find(".ignition-wc-search-results-item-thumb").remove(),e.find(".ignition-wc-search-results-item-excerpt").remove(),e.find(".ignition-wc-search-results-item-price").remove(),e.addClass("error").find(".ignition-wc-search-results-item-title").text(n),void g.html(e).show()}var t=i.data;if(0===t.length){var r=m.clone();return r.find(".ignition-wc-search-results-item-thumb").remove(),r.find(".ignition-wc-search-results-item-excerpt").remove(),r.find(".ignition-wc-search-results-item-price").remove(),r.find(".ignition-wc-search-results-item-title").text(ignition_wc_search.search_no_products),void g.html(r).show()}var o=t.map(function(i){var e=m.clone();return e.find("a").attr("href",i.url),i.image?e.find(".ignition-wc-search-results-item-thumb").html(i.image):e.find(".ignition-wc-search-results-item-thumb").remove(),e.find(".ignition-wc-search-results-item-title").text(i.title),e.find(".ignition-wc-search-results-item-excerpt").text(i.excerpt),e.find(".ignition-wc-search-results-item-price").html(i.price),e});g.html(o),g.show()}))}var s=(i(window),i("body")),a=i(".ignition-wc-search-form-wrap"),h=i(".ignition-wc-search-form"),l=i(".ignition-wc-search-form-trigger"),u=i(".ignition-wc-search-form-dismiss");l.on("click",n),u.on("click",e),i(document).on("keydown",function(i){i=i||window.e,27===i.keyCode&&t()&&e(i)}),s.on("click",function(i){t()&&e()}).find(".ignition-wc-search-form, .ignition-wc-search-form-trigger").on("click",function(i){i.stopPropagation()});var f=i(".ignition-wc-search-select"),d=i(".ignition-wc-search-input"),g=i(".ignition-wc-search-results"),m=i(".ignition-wc-search-results-item"),w=(i(".ignition-wc-search-spinner"),function(i,e,n){var t;return function(){var r=this,o=arguments,c=function(){t=null,n||i.apply(r,o)},s=n&&!t;clearTimeout(t),t=setTimeout(c,e),s&&i.apply(r,o)}}(c,500));h.hasClass("form-ajax-enabled")&&(d.on("change keyup focus",function(e){if(!(["ArrowDown","ArrowUp","ArrowLeft","ArrowRight","Escape"].indexOf(e.key)>=0)){var n=i(this);if(n.val().trim().length<3)return void r();w(f.val(),n.val())}}),d.on("keydown",function(i){if("Escape"===i.key&&r(),"ArrowDown"===i.key||"ArrowUp"===i.key){var e=g.children(),n=g.find(".highlighted"),t=n.index();if(0!==e.length&&e){if("ArrowDown"===i.key){var o=e.eq(t+1);o.length&&(e.removeClass("highlighted"),o.addClass("highlighted")),i.preventDefault()}if("ArrowUp"===i.key){var c=e.eq(t-1);c.length&&(e.removeClass("highlighted"),c.addClass("highlighted")),i.preventDefault()}}}}),h.on("submit",function(i){var e=g.find(".highlighted");e.length>0&&(i.preventDefault(),window.location=e.find("a").attr("href"))})),s.on("click",function(){r()}).find(".ignition-wc-search-input, .ignition-wc-search-select").on("click",function(i){i.stopPropagation()})});